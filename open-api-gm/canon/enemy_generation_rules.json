{
  "schema": "veinbreaker.enemy_generation_rules.v1",

  "general": {
    "enemiesMustUseCanonArchetypes": true,
    "enemiesMustUseCanonTemplates": true,
    "aiMayNotInventEnemies": true,
    "enemyStatsDerivedFromTier": true
  },

  "inputs": {
    "partySize": {
      "min": 1,
      "max": 5
    },
    "partyTotalMarks": {
      "source": "sum(bloodMarks + duns)"
    },
    "partyAverageTier": {
      "source": "average(player.tier)"
    },
    "arenaTags": {
      "type": "array",
      "examples": ["cramped", "open", "vertical", "dark", "hazardous"]
    },
    "desiredDifficulty": {
      "enum": ["easy", "standard", "hard", "desperate"]
    }
  },

  "threatBudget": {
    "baseByPartySize": {
      "1": 2,
      "2": 3,
      "3": 4,
      "4": 5,
      "5": 6
    },
    "difficultyModifier": {
      "easy": -1,
      "standard": 0,
      "hard": 1,
      "desperate": 2
    },
    "bloodMarkPressureModifier": {
      "thresholds": [
        { "marks": 3, "modifier": 1 },
        { "marks": 5, "modifier": 2 }
      ]
    },
    "arenaModifier": {
      "cramped": 1,
      "hazardous": 1,
      "open": 0,
      "vertical": 0,
      "dark": 0
    }
  },

  "enemyCostByTier": {
    "1": 1,
    "2": 2,
    "3": 3
  },

  "compositionRules": {
    "maxSingleEnemyTierAbovePartyAverage": 1,
    "minEnemies": 1,
    "maxEnemies": 5,
    "allowMixedArchetypes": true,
    "noDuplicateEliteEnemies": true
  },

  "archetypeSelection": {
    "weights": {
      "brute": 1,
      "stalker": 1,
      "controller": 1,
      "harrier": 1
    },
    "arenaBias": {
      "cramped": ["brute", "stalker"],
      "open": ["harrier"],
      "dark": ["stalker"],
      "hazardous": ["controller"]
    }
  },

  "templateApplication": {
    "required": true,
    "templateTypes": [
      "baseline",
      "elite",
      "swarm"
    ],
    "eliteCostModifier": 1,
    "swarmCostModifier": -1
  },

  "interruptProfiles": {
    "default": {
      "maxInterruptsPerRound": 1,
      "preferredTriggers": ["negative_balance", "miss"]
    },
    "stalker": {
      "preferredTriggers": ["movement_during_chain", "miss"]
    },
    "brute": {
      "preferredTriggers": ["overcommit"]
    },
    "controller": {
      "preferredTriggers": ["negative_balance"]
    }
  },

  "reinforcements": {
    "allowed": true,
    "maxWaves": 2,
    "reinforcementCost": 1,
    "triggerConditions": [
      "round >= 3",
      "partyDominating",
      "hunterPressureHigh"
    ]
  },

  "scalingRules": {
    "noHpInflation": true,
    "increasePressureNotStats": true,
    "scalingMethods": [
      "add_archetype",
      "add_hazard",
      "enable_reinforcements"
    ]
  },

  "hunterInteraction": {
    "hunterSuppressesReinforcements": false,
    "hunterMayReplaceEncounter": true,
    "hunterOverridesThreatBudget": true
  },

  "validation": {
    "totalEnemyCostMustNotExceedThreatBudget": true,
    "enemyTierMustBeValid": true,
    "archetypeMustExist": true,
    "templateMustExist": true
  },

  "output": {
    "enemyObjects": {
      "requiredFields": [
        "id",
        "archetype",
        "tier",
        "template",
        "traits",
        "abilities",
        "interruptProfile"
      ]
    }
  }
}
